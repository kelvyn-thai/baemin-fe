"use strict";(self.webpackChunkbaemin_fe=self.webpackChunkbaemin_fe||[]).push([[245],{4245:function(e,t,r){r.r(t),r.d(t,{default:function(){return Y}});var n=r(885),a=r(4165),i=r(5861),c=r(2791),s=r(7689),o=r(6731),d=r(4164),u=r(184),l=function(e){var t=e.children;return d.createPortal((0,u.jsx)("div",{className:"fixed-bottom-container",children:t}),document.querySelector("#fixed-bottom-root"))},m=c.memo(l),x=function(e){var t=e.children;return(0,u.jsx)(m,{children:t})},f=c.memo(x),h=r(1413),p=r(1113),v={isVisible:!1,content:null,data:{}},j=(0,p.M)((function(e){return(0,h.Z)((0,h.Z)({},v),{},{actionOpenFixedBottom:function(t){var r=t.content,n=t.data;return e({data:n,content:r,isVisible:!0})},actionCloseFixedBottom:function(){return e((0,h.Z)({},v))}})}),"useFixedBottomStore"),b=(0,n.Z)(j,1)[0],g=function(e){var t=e.children,r=e.className,n=b().actionCloseFixedBottom;return(0,u.jsxs)("div",{className:"fixed-bottom-content box-shadow shadow-black left-0 top-5 right-0 h-[100%] border-solid border-[1px] rounded-xl absolute bg-white text-black overflow-x-hidden overflow-y-scroll ".concat(r&&r),children:[(0,u.jsx)("div",{className:"text-right flex justify-start h-8 items-center mb-1",children:(0,u.jsx)("i",{className:"cursor-pointer text-right fa-solid fa-circle-xmark fa-2xl text-primary-gray",onClick:n})}),t]})};g.defaultProps={className:""};var I=f,Z=r(2982),y={cart:{items:[],categoryId:"",merchantId:"",userId:""}},N=(0,p.M)((function(e,t){return(0,h.Z)((0,h.Z)({},y),{},{actionAddItemToCart:function(r){var n=t().cart,a=n.items,i=(0,h.Z)((0,h.Z)({},n),{},{items:[].concat((0,Z.Z)(a),[r])});e({cart:i})},actionUpdateItemFromCart:function(r){var n=t().cart,a=n.items;e({cart:(0,h.Z)((0,h.Z)({},n),{},{items:a.map((function(e){return e.id===r.id?r:e}))})})},actionRemoveItemFromCart:function(r){var n=t().cart,a=n.items;e({cart:(0,h.Z)((0,h.Z)({},n),{},{items:a.filter((function(e){return e.id!==r}))})})},actionInitCart:function(r){var n=r.merchantId,a=r.categoryId,i=r.userId;return e({cart:(0,h.Z)((0,h.Z)({},t().cart),{},{categoryId:a,merchantId:n,userId:i})})},actionResetCard:function(){return e((0,h.Z)({},y))}})}),"useCartStore"),C=(0,n.Z)(N,1)[0],k=r(4280),w=r(1020),F=r(3917),P=r(6885),q=r(8286),A=r(185),R=function(e){var t=e.min,r=e.max,n=e.handleIncrementCount,a=e.handleDecrementCount,i=e.count,s=c.useMemo((function(){return t===i}),[i,t]),o=c.useMemo((function(){return r===i}),[i,r]);return(0,u.jsxs)("div",{className:"count-box grid gap-4 items-center",children:[(0,u.jsx)(w.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:a,isDisabled:s,children:"-"}),(0,u.jsx)("div",{className:"font-medium",children:i}),(0,u.jsx)(w.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:n,isDisabled:o,children:"+"})]})};R.defaultProps={min:1,max:Number.MAX_SAFE_INTEGER};var M=c.memo(R),S=function(e){var t=e.data,r=e.onSelectedItem,n=t.value,a=t.isChecked,i=t.accessory,c=t.label;return(0,u.jsxs)("div",{className:"radio-container grid gap-3 items-center p-3 border-[0.5px]",onClick:function(){return r(t)},children:[(0,u.jsx)("input",{type:"radio",value:n,checked:a,name:c,onChange:function(){return r(t)},className:"w-5 h-5 cursor-pointer relative"}),(0,u.jsx)("label",{htmlFor:c,children:c}),i&&i]},n)},E=function(e){var t=e.data,r=e.onSelectedItem,n=t.value,a=t.isChecked,i=t.label,c=t.accessory;return(0,u.jsxs)("div",{className:"checkbox-container grid gap-3 items-center cursor-pointer p-3 border-[0.5px]",onClick:function(){return r(t)},children:[(0,u.jsxs)("div",{className:"checkbox-input relative w-6 h-6",children:[(0,u.jsx)("input",{type:"checkbox",value:n,checked:a,name:i,onChange:function(){return r(t)},className:"hidden"}),(0,u.jsx)("span",{className:"checkmark absolute left-0 top-0 w-[100%] h-[100%] rounded border-[1px]"})]}),(0,u.jsx)("label",{htmlFor:i,children:i}),c&&c]},n)},_=function(e){var t=e.data,r=e.cart,a=e.setCart,i=c.useCallback((function(e,t,i){var c="".concat(t.id,"/").concat(e.id),s=r.extraItem.includes(c);switch(i){case"checkbox":a((0,h.Z)((0,h.Z)({},r),{},{extraItem:s?r.extraItem.filter((function(e){return e!==c})):[].concat((0,Z.Z)(r.extraItem),[c])}));break;case"radio":var o=r.extraItem.findIndex((function(e){var r=e.split("/");return(0,n.Z)(r,1)[0]===t.id})),d=-1!==o;a((0,h.Z)((0,h.Z)({},r),{},{extraItem:d?(0,Z.Z)(r.extraItem).map((function(e,t){return t===o?c:e})):[].concat((0,Z.Z)(r.extraItem),[c])}))}}),[t,r]);return(0,u.jsx)("div",{children:Object.entries(t).map((function(e){var t=(0,n.Z)(e,2)[1],a=t.id,c=t.name,s=t.items,o=t.isRequired,d=o?"radio":"checkbox";return(0,u.jsxs)("div",{className:"extra-container",children:[(0,u.jsxs)("div",{className:"bg-primary-light-gray p-4",children:[(0,u.jsx)("div",{className:"font-medium text-primary-dark",children:c}),o&&(0,u.jsx)("div",{className:"text-xs font-light text-primary-warning mt-1",children:"Must select 1 item(s)"})]}),(0,u.jsx)("div",{className:"extra-list",children:s.map((function(e){var n="".concat(a,"/").concat(e.id),c=r.extraItem.includes(n),s={id:e.id,label:e.name,value:e.id,accessory:(0,u.jsx)("div",{children:(0,k.e)({value:e.price})}),isChecked:c};switch(d){case"radio":return(0,u.jsx)(S,{data:s,onSelectedItem:function(e){return i(e,t,d)}},n);case"checkbox":return(0,u.jsx)(E,{data:s,onSelectedItem:function(e){return i(e,t,d)}},n);default:return null}}))})]},a)}))})},U=c.memo(_),D=function(e){var t=e.data,r=t.id,a=t.imgURL,i=t.extraItem,s=t.name,o=t.priceFormatted,d=t.price,l=C(),m=l.cart,x=l.actionAddItemToCart,f=l.actionUpdateItemFromCart,p=m.items.find((function(e){return e.id===r})),v=!(null===p||void 0===p||!p.id),j=c.useState(v?p:{id:r,quantity:1,extraItem:[],note:"",totalPrice:0}),b=(0,n.Z)(j,2),g=b[0],Z=b[1],y=(0,A.aE)().actionCloseModal,N=c.useMemo((function(){var e=g.quantity,t=d*e+g.extraItem.reduce((function(e,t){var r,a=t.split("/"),c=(0,n.Z)(a,2),s=c[0],o=c[1];return e+((null===(r=i[s].items.find((function(e){return e.id===o})))||void 0===r?void 0:r.price)||0)}),0);return{totalPrice:t,totalPriceFormatted:(0,k.e)({value:t})}}),[t,g]),F=N.totalPriceFormatted,P=N.totalPrice,q=c.useCallback((function(){v?f((0,h.Z)((0,h.Z)({},g),{},{totalPrice:P})):x((0,h.Z)((0,h.Z)({},g),{},{totalPrice:P})),y()}),[g,v,P]);return(0,u.jsxs)(A.hz,{className:"pb-40",children:[(0,u.jsx)("div",{className:"flex items-center justify-center h-60",children:(0,u.jsx)("img",{src:a,alt:s,className:"h-[100%]"})}),(0,u.jsxs)("div",{className:"px-2 py-4",children:[(0,u.jsxs)("div",{className:"grid gap-2 grid-cols-2 items-center mb-2",children:[(0,u.jsx)("div",{className:"text-left font-medium text-xl",children:s}),(0,u.jsx)("div",{className:"text-right",children:o})]}),(0,u.jsxs)("div",{className:"grid items-center gap-2 note",children:[(0,u.jsx)("i",{className:"fa-regular fa-file-lines text-base"}),(0,u.jsx)("input",{placeholder:"Any note for store?",value:g.note,onChange:function(e){return Z((0,h.Z)((0,h.Z)({},g),{},{note:e.target.value}))}})]})]}),(0,u.jsx)(U,{cart:g,setCart:Z,data:i}),(0,u.jsx)(I,{children:(0,u.jsxs)("div",{className:"operation-block grid items-center gap-4",children:[(0,u.jsx)(M,{count:g.quantity,min:1,handleDecrementCount:function(){return Z((0,h.Z)((0,h.Z)({},g),{},{quantity:g.quantity-1}))},handleIncrementCount:function(){return Z((0,h.Z)((0,h.Z)({},g),{},{quantity:g.quantity+1}))}}),(0,u.jsx)(w.Z,{title:"".concat(v?"Update":"Add"," - ").concat(F),className:"w-[100%]",onClick:q})]})})]})},L=c.memo(D),B=function(e){var t=e.data,r=t.imgURL,n=t.name,a=t.priceFormatted,i=(0,A.aE)().actionOpenModal,s=c.useCallback((function(){i({content:(0,u.jsx)(L,{data:t})})}),[t,i]);return(0,u.jsxs)("button",{onClick:s,type:"button",className:"",children:[(0,u.jsx)("div",{className:"border-solid border-[1px] rounded h-36 flex items-end justify-center mb-1 pb-2",children:(0,u.jsx)("img",{src:r,alt:n,className:"h-[90%]"})}),(0,u.jsx)("div",{className:"text-primary-dark text-left",children:n}),(0,u.jsx)("div",{className:"text-primary-dark font-light text-left",children:a})]})},O=c.memo(B),T=r(1017),V=r(7408),K=r(5824),Q=new(r(7928).Z)({baseURL:"".concat(K.V.REACT_APP_API_DOMAIN_URL,"/items")}),z=function(e){return Q.get("?merchantId=".concat(e))},G=function(e){var t=e.merchantId,r=(0,V.useQuery)({queryFn:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,z(t);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),queryKey:["items",t],enabled:!!t});return r},X=function(){var e=(0,o.lr)(),t=(0,n.Z)(e,1)[0].get("merchantId")||"",r=G({merchantId:t}).isLoading,a=function(e){var t=e.merchantId,r=G({merchantId:t}).data;return(void 0===r?[]:r).map((function(e){return(0,h.Z)((0,h.Z)({},e),{},{priceFormatted:(0,k.e)({value:e.price})})}))}({merchantId:t});return(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[r&&(0,u.jsx)(T.Z,{}),a.map((function(e){return(0,u.jsx)(O,{data:e},e.id)}))]})},H=c.memo(X),J=c.memo((function(){var e=(0,s.s0)(),t=function(){var e=C().cart.items,t=0===e.length,r=e.reduce((function(e,t){return e+t.quantity}),0),n=e.reduce((function(e,t){return e+t.extraItem.length}),0),a=e.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.totalPrice)||0)}),0);return{totalItem:r,totalPrice:a,isCartEmpty:t,totalPriceFormatted:(0,k.e)({value:a}),totalSubItem:n}}(),r=t.isCartEmpty,n=t.totalItem,c=t.totalPriceFormatted,o=C(),d=o.cart,l=o.actionResetCard,m=(0,q.hQ)(),x=m.isLoading,f=function(){var t=(0,i.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.mutateAsync(d);case 2:l(),e("/");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r?null:(0,u.jsx)(I,{children:(0,u.jsxs)("div",{className:"grid gap-4 cart-block",children:[(0,u.jsxs)(w.Z,{type:"default",className:"flex items-center gap-2",children:[(0,u.jsx)("i",{className:"fas fa-shopping-cart text-lg"}),n]}),(0,u.jsx)(w.Z,{onClick:f,isDisabled:x,children:x?"Checkout...":"Checkout - ".concat(c)})]})})})),W=function(){var e=(0,o.lr)(),t=(0,n.Z)(e,1)[0],r=C().actionInitCart,a=(0,P.q)().userInfo,i=t.get("merchantId")||"",d=t.get("categoryId")||"";return i&&d&&a?(c.useEffect((function(){r({merchantId:i,categoryId:d,userId:a.id})}),[i,d]),(0,u.jsxs)("div",{className:"p-2",children:[(0,u.jsx)(H,{}),(0,u.jsx)(J,{})]})):(0,u.jsx)(s.Fg,{to:"/"})},Y=c.memo((function(){return(0,u.jsx)(F.Kf,{userRole:"customer",children:(0,u.jsx)(W,{})})}))}}]);
//# sourceMappingURL=245.dd552ddd.chunk.js.map