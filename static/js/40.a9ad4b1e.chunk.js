"use strict";(self.webpackChunkbaemin_fe=self.webpackChunkbaemin_fe||[]).push([[40],{1040:function(e,t,n){function r(e){var t=e.min,n=e.max,r=e.handleIncrementCount,a=e.handleDecrementCount,c=e.count,i=(e=d.useMemo((function(){return t===c}),[c,t]),d.useMemo((function(){return n===c}),[c,n]));return(0,f.jsxs)("div",{className:"count-box grid gap-4 items-center",children:[(0,f.jsx)(N.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:a,isDisabled:e,children:"-"}),(0,f.jsx)("div",{className:"font-medium",children:c}),(0,f.jsx)(N.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:r,isDisabled:i,children:"+"})]})}function a(e){var t=e.data,n=e.onSelectedItem,r=(e=t.value,t.isChecked),a=t.accessory,c=t.label;return(0,f.jsxs)("div",{className:"radio-container grid gap-3 items-center p-3 border-[0.5px]",onClick:function(){return n(t)},children:[(0,f.jsx)("input",{type:"radio",value:e,checked:r,name:c,onChange:function(){return n(t)},className:"w-5 h-5 cursor-pointer relative"}),(0,f.jsx)("label",{htmlFor:c,children:c}),a]},e)}function c(e){var t=e.data,n=e.onSelectedItem,r=(e=t.value,t.isChecked),a=t.label,c=t.accessory;return(0,f.jsxs)("div",{className:"checkbox-container grid gap-3 items-center cursor-pointer p-3 border-[0.5px]",onClick:function(){return n(t)},children:[(0,f.jsxs)("div",{className:"checkbox-input relative w-6 h-6",children:[(0,f.jsx)("input",{type:"checkbox",value:e,checked:r,name:a,onChange:function(){return n(t)},className:"hidden"}),(0,f.jsx)("span",{className:"checkmark absolute left-0 top-0 w-[100%] h-[100%] rounded border-[1px]"})]}),(0,f.jsx)("label",{htmlFor:a,children:a}),c]},e)}function i(){var e=(0,m.lr)(),t=(e=(0,s.Z)(e,1)[0],y().actionInitCart),n=(0,F.q)().userInfo,r=e.get("merchantId")||"",a=e.get("categoryId")||"";return r&&a&&n?(d.useEffect((function(){t({merchantId:r,categoryId:a,userId:n.id})}),[r,a]),(0,f.jsxs)("div",{className:"p-2",children:[(0,f.jsx)(L,{}),(0,f.jsx)(O,{})]})):(0,f.jsx)(l.Fg,{to:"/"})}n.r(t),n.d(t,{default:function(){return T}});var s=n(885),o=n(4165),u=n(5861),d=n(2791),l=n(7689),m=n(6731),x=n(4164),f=n(184),h=d.memo((function(e){return e=e.children,x.createPortal((0,f.jsx)("div",{className:"fixed-bottom-container",children:e}),document.querySelector("#fixed-bottom-root"))})),p=(t=d.memo((function(e){return e=e.children,(0,f.jsx)(h,{children:e})})),n(1413)),v=n(1113),j={isVisible:!1,content:null,data:{}},g=(0,v.M)((function(e){return(0,p.Z)((0,p.Z)({},j),{},{actionOpenFixedBottom:function(t){var n=t.content;t=t.data;return e({data:t,content:n,isVisible:!0})},actionCloseFixedBottom:function(){return e((0,p.Z)({},j))}})}),"useFixedBottomStore"),b=((0,s.Z)(g,1)[0],t),I=n(2982),Z={cart:{items:[],categoryId:"",merchantId:"",userId:""}},y=(g=(0,v.M)((function(e,t){return(0,p.Z)((0,p.Z)({},Z),{},{actionAddItemToCart:function(n){var r=(a=t().cart).items,a=(0,p.Z)((0,p.Z)({},a),{},{items:[].concat((0,I.Z)(r),[n])});e({cart:a})},actionUpdateItemFromCart:function(n){var r=t().cart,a=r.items;e({cart:(0,p.Z)((0,p.Z)({},r),{},{items:a.map((function(e){return e.id===n.id?n:e}))})})},actionRemoveItemFromCart:function(n){var r=t().cart,a=r.items;e({cart:(0,p.Z)((0,p.Z)({},r),{},{items:a.filter((function(e){return e.id!==n}))})})},actionInitCart:function(n){var r=n.merchantId,a=n.categoryId;n=n.userId;return e({cart:(0,p.Z)((0,p.Z)({},t().cart),{},{categoryId:a,merchantId:r,userId:n})})},actionResetCard:function(){return e((0,p.Z)({},Z))}})}),"useCartStore"),(0,s.Z)(g,1)[0]),C=n(4280),N=n(1020),k=n(3917),F=n(6885),w=n(8286),P=n(4482),q=(r.defaultProps={min:1,max:Number.MAX_SAFE_INTEGER},d.memo(r)),A=d.memo((function(e){var t=e.data,n=e.cart,r=e.setCart,i=d.useCallback((function(e,t,a){var c="".concat(t.id,"/").concat(e.id),i=n.extraItem.includes(c);switch(a){case"checkbox":r((0,p.Z)((0,p.Z)({},n),{},{extraItem:i?n.extraItem.filter((function(e){return e!==c})):[].concat((0,I.Z)(n.extraItem),[c])}));break;case"radio":var o=n.extraItem.findIndex((function(e){return e=e.split("/"),(0,s.Z)(e,1)[0]===t.id})),u=-1!==o;r((0,p.Z)((0,p.Z)({},n),{},{extraItem:u?(0,I.Z)(n.extraItem).map((function(e,t){return t===o?c:e})):[].concat((0,I.Z)(n.extraItem),[c])}))}}),[t,n]);return(0,f.jsx)("div",{children:Object.entries(t).map((function(e){var t=(0,s.Z)(e,2)[1],r=t.id,o=(e=t.name,t.items),u=t.isRequired,d=u?"radio":"checkbox";return(0,f.jsxs)("div",{className:"extra-container",children:[(0,f.jsxs)("div",{className:"bg-primary-light-gray p-4",children:[(0,f.jsx)("div",{className:"font-medium text-primary-dark",children:e}),u&&(0,f.jsx)("div",{className:"text-xs font-light text-primary-warning mt-1",children:"Must select 1 item(s)"})]}),(0,f.jsx)("div",{className:"extra-list",children:o.map((function(e){var s="".concat(r,"/").concat(e.id),o=n.extraItem.includes(s),u={id:e.id,label:e.name,value:e.id,accessory:(0,f.jsx)("div",{children:(0,C.e)({value:e.price})}),isChecked:o};switch(d){case"radio":return(0,f.jsx)(a,{data:u,onSelectedItem:function(e){return i(e,t,d)}},s);case"checkbox":return(0,f.jsx)(c,{data:u,onSelectedItem:function(e){return i(e,t,d)}},s);default:return null}}))})]},r)}))})})),R=d.memo((function(e){var t=(e=e.data).id,n=e.imgURL,r=e.extraItem,a=e.name,c=e.priceFormatted,i=e.price,o=(m=y()).cart,u=m.actionAddItemToCart,l=m.actionUpdateItemFromCart,m=o.items.find((function(e){return e.id===t})),x=!(null==m||!m.id),h=(o=d.useState(x?m:{id:t,quantity:1,extraItem:[],note:"",totalPrice:0}),(m=(0,s.Z)(o,2))[0]),v=m[1],j=(0,P.aE)().actionCloseModal,g=(o=d.useMemo((function(){var e=h.quantity;e=i*e+h.extraItem.reduce((function(e,t){t=t.split("/");var n=(t=(0,s.Z)(t,2))[0],a=t[1];return e+((null==(t=r[n].items.find((function(e){return e.id===a})))?void 0:t.price)||0)}),0);return{totalPrice:e,totalPriceFormatted:(0,C.e)({value:e})}}),[e,h]),m=o.totalPriceFormatted,o.totalPrice);e=d.useCallback((function(){(x?l:u)((0,p.Z)((0,p.Z)({},h),{},{totalPrice:g})),j()}),[h,x,g]);return(0,f.jsxs)(P.hz,{className:"pb-40",children:[(0,f.jsx)("div",{className:"flex items-center justify-center h-60",children:(0,f.jsx)("img",{src:n,alt:a,className:"h-[100%]"})}),(0,f.jsxs)("div",{className:"px-2 py-4",children:[(0,f.jsxs)("div",{className:"grid gap-2 grid-cols-2 items-center mb-2",children:[(0,f.jsx)("div",{className:"text-left font-medium text-xl",children:a}),(0,f.jsx)("div",{className:"text-right",children:c})]}),(0,f.jsxs)("div",{className:"grid items-center gap-2 note",children:[(0,f.jsx)("i",{className:"fa-regular fa-file-lines text-base"}),(0,f.jsx)("input",{placeholder:"Any note for store?",value:h.note,onChange:function(e){return v((0,p.Z)((0,p.Z)({},h),{},{note:e.target.value}))}})]})]}),(0,f.jsx)(A,{cart:h,setCart:v,data:r}),(0,f.jsx)(b,{children:(0,f.jsxs)("div",{className:"operation-block grid items-center gap-4",children:[(0,f.jsx)(q,{count:h.quantity,min:1,handleDecrementCount:function(){return v((0,p.Z)((0,p.Z)({},h),{},{quantity:h.quantity-1}))},handleIncrementCount:function(){return v((0,p.Z)((0,p.Z)({},h),{},{quantity:h.quantity+1}))}}),(0,f.jsx)(N.Z,{title:"".concat(x?"Update":"Add"," - ").concat(m),className:"w-[100%]",onClick:e})]})})]})})),M=d.memo((function(e){var t=e.data,n=(e=t.imgURL,t.name),r=t.priceFormatted,a=(0,P.aE)().actionOpenModal,c=d.useCallback((function(){a({content:(0,f.jsx)(R,{data:t})})}),[t,a]);return(0,f.jsxs)("button",{onClick:c,type:"button",className:"",children:[(0,f.jsx)("div",{className:"border-solid border-[1px] rounded h-36 flex items-end justify-center mb-1 pb-2",children:(0,f.jsx)("img",{src:e,alt:n,className:"h-[90%]"})}),(0,f.jsx)("div",{className:"text-primary-dark text-left",children:n}),(0,f.jsx)("div",{className:"text-primary-dark font-light text-left",children:r})]})})),S=n(1017),E=n(7408),_=(t=n(5824),new(n(7928).Z)({baseURL:"".concat(t.V.REACT_APP_API_DOMAIN_URL,"/items")})),U=function(e){return _.get("?merchantId=".concat(e))},D=function(e){var t,n=e.merchantId;return(0,E.useQuery)({queryFn:(t=(0,u.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,U(n);case 4:return t=e.sent,e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),queryKey:["items",n],enabled:!!n})},L=d.memo((function(){var e=(0,m.lr)(),t=(e=(0,s.Z)(e,1)[0].get("merchantId")||"",D({merchantId:e}).isLoading);e=function(e){return e=e.merchantId,(void 0===(e=D({merchantId:e}).data)?[]:e).map((function(e){return(0,p.Z)((0,p.Z)({},e),{},{priceFormatted:(0,C.e)({value:e.price})})}))}({merchantId:e});return(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[t&&(0,f.jsx)(S.Z,{}),e.map((function(e){return(0,f.jsx)(M,{data:e},e.id)}))]})})),O=d.memo((function(){var e=(0,l.s0)(),t=(n=0===(r=y().cart.items).length,t=r.reduce((function(e,t){return e+t.quantity}),0),a=r.reduce((function(e,t){return e+t.extraItem.length}),0),r=r.reduce((function(e,t){return e+((null==t?void 0:t.totalPrice)||0)}),0),{totalItem:t,totalPrice:r,isCartEmpty:n,totalPriceFormatted:(0,C.e)({value:r}),totalSubItem:a}),n=t.isCartEmpty,r=t.totalItem,a=t.totalPriceFormatted,c=(t=y()).cart,i=t.actionResetCard,s=(0,w.hQ)();t=s.isLoading;return n?null:(0,f.jsx)(b,{children:(0,f.jsxs)("div",{className:"grid gap-4 cart-block",children:[(0,f.jsxs)(N.Z,{type:"default",className:"flex items-center gap-2",children:[(0,f.jsx)("i",{className:"fas fa-shopping-cart text-lg"}),r]}),(0,f.jsx)(N.Z,{onClick:function(){var t=(0,u.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.mutateAsync(c);case 2:i(),e("/");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isDisabled:t,children:t?"Checkout...":"Checkout - ".concat(a)})]})})})),T=d.memo((function(){return(0,f.jsx)(k.Kf,{userRole:"customer",children:(0,f.jsx)(i,{})})}))}}]);