"use strict";(self.webpackChunkbaemin_fe=self.webpackChunkbaemin_fe||[]).push([[39,581],{6581:function(e,t,r){function n(e){var t=e.children,r=(e=e.className,l().actionCloseFixedBottom);return(0,i.jsxs)("div",{className:"fixed-bottom-content box-shadow shadow-black left-0 top-5 right-0 h-[100%] border-solid border-[1px] rounded-xl absolute bg-white text-black overflow-x-hidden overflow-y-scroll ".concat(e),children:[(0,i.jsx)("div",{className:"text-right flex justify-start h-8 items-center mb-1",children:(0,i.jsx)("i",{className:"cursor-pointer text-right fa-solid fa-circle-xmark fa-2xl text-primary-gray",onClick:r})}),t]})}r.r(t),r.d(t,{FixedBottomContent:function(){return m},default:function(){return x},useFixedBottomStore:function(){return l}});t=r(2791);var a=r(4164),i=r(184),c=t.memo((function(e){return e=e.children,a.createPortal((0,i.jsx)("div",{className:"fixed-bottom-container",children:e}),document.querySelector("#fixed-bottom-root"))})),s=t.memo((function(e){return e=e.children,(0,i.jsx)(c,{children:e})})),o=r(1413),d=r(885),u=(r=r(1113),{isVisible:!1,content:null,data:{}}),l=(r=(0,r.M)((function(e){return(0,o.Z)((0,o.Z)({},u),{},{actionOpenFixedBottom:function(t){var r=t.content;t=t.data;return e({data:t,content:r,isVisible:!0})},actionCloseFixedBottom:function(){return e((0,o.Z)({},u))}})}),"useFixedBottomStore"),(0,d.Z)(r,1)[0]),m=(n.defaultProps={className:""},t.memo(n)),x=s},39:function(e,t,r){function n(e){var t=e.min,r=e.max,n=e.handleIncrementCount,a=e.handleDecrementCount,i=e.count,c=(e=u.useMemo((function(){return t===i}),[i,t]),u.useMemo((function(){return r===i}),[i,r]));return(0,C.jsxs)("div",{className:"count-box grid gap-4 items-center",children:[(0,C.jsx)(b.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:a,isDisabled:e,children:"-"}),(0,C.jsx)("div",{className:"font-medium",children:i}),(0,C.jsx)(b.Z,{className:"h-6 w-6 p-0 bg-primary-light-gray-1 text-primary-btn font-medium",onClick:n,isDisabled:c,children:"+"})]})}function a(e){var t=e.data,r=e.onSelectedItem,n=(e=t.value,t.isChecked),a=t.accessory,i=t.label;return(0,C.jsxs)("div",{className:"radio-container grid gap-3 items-center p-3 border-[0.5px]",onClick:function(){return r(t)},children:[(0,C.jsx)("input",{type:"radio",value:e,checked:n,name:i,onChange:function(){return r(t)},className:"w-5 h-5 cursor-pointer relative"}),(0,C.jsx)("label",{htmlFor:i,children:i}),a]},e)}function i(e){var t=e.data,r=e.onSelectedItem,n=(e=t.value,t.isChecked),a=t.label,i=t.accessory;return(0,C.jsxs)("div",{className:"checkbox-container grid gap-3 items-center cursor-pointer p-3 border-[0.5px]",onClick:function(){return r(t)},children:[(0,C.jsxs)("div",{className:"checkbox-input relative w-6 h-6",children:[(0,C.jsx)("input",{type:"checkbox",value:e,checked:n,name:a,onChange:function(){return r(t)},className:"hidden"}),(0,C.jsx)("span",{className:"checkmark absolute left-0 top-0 w-[100%] h-[100%] rounded border-[1px]"})]}),(0,C.jsx)("label",{htmlFor:a,children:a}),i]},e)}function c(){var e=(0,m.lr)(),t=(e=(0,s.Z)(e,1)[0],v().actionInitCart),r=(0,I.q)().userInfo,n=e.get("merchantId")||"",a=e.get("categoryId")||"";return n&&a&&r?(u.useEffect((function(){t({merchantId:n,categoryId:a,userId:r.id})}),[n,a]),(0,C.jsxs)("div",{className:"p-2",children:[(0,C.jsx)(R,{}),(0,C.jsx)(_,{})]})):(0,C.jsx)(l.Fg,{to:"/"})}r.r(t),r.d(t,{default:function(){return E}});var s=r(885),o=r(4165),d=r(5861),u=r(2791),l=r(7689),m=r(6731),x=r(6581),f=r(2982),h=r(1413),p=(t=r(1113),{cart:{items:[],categoryId:"",merchantId:"",userId:""}}),v=(t=(0,t.M)((function(e,t){return(0,h.Z)((0,h.Z)({},p),{},{actionAddItemToCart:function(r){var n=(a=t().cart).items,a=(0,h.Z)((0,h.Z)({},a),{},{items:[].concat((0,f.Z)(n),[r])});e({cart:a})},actionUpdateItemFromCart:function(r){var n=t().cart,a=n.items;e({cart:(0,h.Z)((0,h.Z)({},n),{},{items:a.map((function(e){return e.id===r.id?r:e}))})})},actionRemoveItemFromCart:function(r){var n=t().cart,a=n.items;e({cart:(0,h.Z)((0,h.Z)({},n),{},{items:a.filter((function(e){return e.id!==r}))})})},actionInitCart:function(r){var n=r.merchantId,a=r.categoryId;r=r.userId;return e({cart:(0,h.Z)((0,h.Z)({},t().cart),{},{categoryId:a,merchantId:n,userId:r})})},actionResetCard:function(){return e((0,h.Z)({},p))}})}),"useCartStore"),(0,s.Z)(t,1)[0]),j=r(4280),b=r(1020),g=r(3917),I=r(6885),Z=r(8286),y=r(4482),C=r(184),N=(n.defaultProps={min:1,max:Number.MAX_SAFE_INTEGER},u.memo(n)),k=u.memo((function(e){var t=e.data,r=e.cart,n=e.setCart,c=u.useCallback((function(e,t,a){var i="".concat(t.id,"/").concat(e.id),c=r.extraItem.includes(i);switch(a){case"checkbox":n((0,h.Z)((0,h.Z)({},r),{},{extraItem:c?r.extraItem.filter((function(e){return e!==i})):[].concat((0,f.Z)(r.extraItem),[i])}));break;case"radio":var o=r.extraItem.findIndex((function(e){return e=e.split("/"),(0,s.Z)(e,1)[0]===t.id})),d=-1!==o;n((0,h.Z)((0,h.Z)({},r),{},{extraItem:d?(0,f.Z)(r.extraItem).map((function(e,t){return t===o?i:e})):[].concat((0,f.Z)(r.extraItem),[i])}))}}),[t,r]);return(0,C.jsx)("div",{children:Object.entries(t).map((function(e){var t=(0,s.Z)(e,2)[1],n=t.id,o=(e=t.name,t.items),d=t.isRequired,u=d?"radio":"checkbox";return(0,C.jsxs)("div",{className:"extra-container",children:[(0,C.jsxs)("div",{className:"bg-primary-light-gray p-4",children:[(0,C.jsx)("div",{className:"font-medium text-primary-dark",children:e}),d&&(0,C.jsx)("div",{className:"text-xs font-light text-primary-warning mt-1",children:"Must select 1 item(s)"})]}),(0,C.jsx)("div",{className:"extra-list",children:o.map((function(e){var s="".concat(n,"/").concat(e.id),o=r.extraItem.includes(s),d={id:e.id,label:e.name,value:e.id,accessory:(0,C.jsx)("div",{children:(0,j.e)({value:e.price})}),isChecked:o};switch(u){case"radio":return(0,C.jsx)(a,{data:d,onSelectedItem:function(e){return c(e,t,u)}},s);case"checkbox":return(0,C.jsx)(i,{data:d,onSelectedItem:function(e){return c(e,t,u)}},s);default:return null}}))})]},n)}))})})),w=u.memo((function(e){var t=(e=e.data).id,r=e.imgURL,n=e.extraItem,a=e.name,i=e.priceFormatted,c=e.price,o=(m=v()).cart,d=m.actionAddItemToCart,l=m.actionUpdateItemFromCart,m=o.items.find((function(e){return e.id===t})),f=!(null==m||!m.id),p=(o=u.useState(f?m:{id:t,quantity:1,extraItem:[],note:"",totalPrice:0}),(m=(0,s.Z)(o,2))[0]),g=m[1],I=(0,y.useModalStore)().actionCloseModal,Z=(o=u.useMemo((function(){var e=p.quantity;e=c*e+p.extraItem.reduce((function(e,t){t=t.split("/");var r=(t=(0,s.Z)(t,2))[0],a=t[1];return e+((null==(t=n[r].items.find((function(e){return e.id===a})))?void 0:t.price)||0)}),0);return{totalPrice:e,totalPriceFormatted:(0,j.e)({value:e})}}),[e,p]),m=o.totalPriceFormatted,o.totalPrice);e=u.useCallback((function(){(f?l:d)((0,h.Z)((0,h.Z)({},p),{},{totalPrice:Z})),I()}),[p,f,Z]);return(0,C.jsxs)(y.ModalContent,{className:"pb-40",children:[(0,C.jsx)("div",{className:"flex items-center justify-center h-60",children:(0,C.jsx)("img",{src:r,alt:a,className:"h-[100%]"})}),(0,C.jsxs)("div",{className:"px-2 py-4",children:[(0,C.jsxs)("div",{className:"grid gap-2 grid-cols-2 items-center mb-2",children:[(0,C.jsx)("div",{className:"text-left font-medium text-xl",children:a}),(0,C.jsx)("div",{className:"text-right",children:i})]}),(0,C.jsxs)("div",{className:"grid items-center gap-2 note",children:[(0,C.jsx)("i",{className:"fa-regular fa-file-lines text-base"}),(0,C.jsx)("input",{placeholder:"Any note for store?",value:p.note,onChange:function(e){return g((0,h.Z)((0,h.Z)({},p),{},{note:e.target.value}))}})]})]}),(0,C.jsx)(k,{cart:p,setCart:g,data:n}),(0,C.jsx)(x.default,{children:(0,C.jsxs)("div",{className:"operation-block grid items-center gap-4",children:[(0,C.jsx)(N,{count:p.quantity,min:1,handleDecrementCount:function(){return g((0,h.Z)((0,h.Z)({},p),{},{quantity:p.quantity-1}))},handleIncrementCount:function(){return g((0,h.Z)((0,h.Z)({},p),{},{quantity:p.quantity+1}))}}),(0,C.jsx)(b.Z,{title:"".concat(f?"Update":"Add"," - ").concat(m),className:"w-[100%]",onClick:e})]})})]})})),F=u.memo((function(e){var t=e.data,r=(e=t.imgURL,t.name),n=t.priceFormatted,a=(0,y.useModalStore)().actionOpenModal,i=u.useCallback((function(){a({content:(0,C.jsx)(w,{data:t})})}),[t,a]);return(0,C.jsxs)("button",{onClick:i,type:"button",className:"",children:[(0,C.jsx)("div",{className:"border-solid border-[1px] rounded h-36 flex items-end justify-center mb-1 pb-2",children:(0,C.jsx)("img",{src:e,alt:r,className:"h-[90%]"})}),(0,C.jsx)("div",{className:"text-primary-dark text-left",children:r}),(0,C.jsx)("div",{className:"text-primary-dark font-light text-left",children:n})]})})),P=r(1017),q=r(7408),M=(t=r(5824),new(r(7928).Z)({baseURL:"".concat(t.V.REACT_APP_API_DOMAIN_URL,"/items")})),S=function(e){return M.get("?merchantId=".concat(e))},A=function(e){var t,r=e.merchantId;return(0,q.useQuery)({queryFn:(t=(0,d.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,S(r);case 4:return t=e.sent,e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),queryKey:["items",r],enabled:!!r})},R=u.memo((function(){var e=(0,m.lr)(),t=(e=(0,s.Z)(e,1)[0].get("merchantId")||"",A({merchantId:e}).isLoading);e=function(e){return e=e.merchantId,(void 0===(e=A({merchantId:e}).data)?[]:e).map((function(e){return(0,h.Z)((0,h.Z)({},e),{},{priceFormatted:(0,j.e)({value:e.price})})}))}({merchantId:e});return(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[t&&(0,C.jsx)(P.Z,{}),e.map((function(e){return(0,C.jsx)(F,{data:e},e.id)}))]})})),_=u.memo((function(){var e=(0,l.s0)(),t=(r=0===(n=v().cart.items).length,t=n.reduce((function(e,t){return e+t.quantity}),0),a=n.reduce((function(e,t){return e+t.extraItem.length}),0),n=n.reduce((function(e,t){return e+((null==t?void 0:t.totalPrice)||0)}),0),{totalItem:t,totalPrice:n,isCartEmpty:r,totalPriceFormatted:(0,j.e)({value:n}),totalSubItem:a}),r=t.isCartEmpty,n=t.totalItem,a=t.totalPriceFormatted,i=(t=v()).cart,c=t.actionResetCard,s=(0,Z.hQ)();t=s.isLoading;return r?null:(0,C.jsx)(x.default,{children:(0,C.jsxs)("div",{className:"grid gap-4 cart-block",children:[(0,C.jsxs)(b.Z,{type:"default",className:"flex items-center gap-2",children:[(0,C.jsx)("i",{className:"fas fa-shopping-cart text-lg"}),n]}),(0,C.jsx)(b.Z,{onClick:function(){var t=(0,d.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.mutateAsync(i);case 2:c(),e("/");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isDisabled:t,children:t?"Checkout...":"Checkout - ".concat(a)})]})})})),E=u.memo((function(){return(0,C.jsx)(g.Kf,{userRole:"customer",children:(0,C.jsx)(c,{})})}))}}]);